



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Publish API &mdash; tk-multi-publish2 v2.6.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Logging" href="logging.html" />
    <link rel="prev" title="Publish Customization" href="customizing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          
    <a href='http://developer.shotgridsoftware.com'>
    
        <img style='width: 191px;
                height: 60px;
                margin: 2px;
                border-radius: 0px;
                padding: 0px;'
            src='_static/logo@2x.png'/>
    
    </a>
    

          
            <a href="index.html" class="icon icon-home"> tk-multi-publish2
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="customizing.html">Publish Customization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Publish API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#publishmanager">PublishManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="#publishtree">PublishTree</a></li>
<li class="toctree-l2"><a class="reference internal" href="#publishitem">PublishItem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#publishtask">PublishTask</a></li>
<li class="toctree-l2"><a class="reference internal" href="#publishdata">PublishData</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pluginsetting">PluginSetting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="application.html">App Interface</a></li>
</ul>

            
          

    <a href='genindex.html'>Alphabetic Index</a>

    <div style='margin-top: 50px;
                margin-left: 10px;
                margin-right: 10px;
                padding: 10px;
                color: #b3b3b3;
                font-size: 70%;
                border-radius: 3px;
                background-color: #444;
                line-height: 18px;
                '>
    <style>
        a.custom_post_menu { display: inline;
                             padding: 0px;
                             text-decoration: underline; }
    </style>

    <b>tk-multi-publish2</b> v2.6.3.<br>
    
        This documentation is part of the ShotGrid Pipeline Toolkit.
    
    For more information, please visit
    <a class=custom_post_menu href='https://developer.shotgridsoftware.com'>The ShotGrid developer portal.</a>.
    The code associated with this documentation can be found
    <a class=custom_post_menu href='https://github.com/shotgunsoftware/tk-multi-publish2'>here</a>.

    </div>
    <style>
        p.privacy_links { margin: 4px 0px;}
    </style>
    <p class="privacy_links"><a data-opt-in-preferences href="javascript:;">Privacy settings</a></p>
    <p class="privacy_links"><a data-wat-linkname="manage-ccpa-settings-footer-link" href="javascript:;">Do not sell my personal information</a></p>
    <p class="privacy_links"><a href="https://www.autodesk.com/company/legal-notices-trademarks/privacy-statement">Privacy/Cookies</a></p>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tk-multi-publish2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Publish API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="publish-api">
<span id="id1"></span><h1>Publish API<a class="headerlink" href="#publish-api" title="Permalink to this headline">¶</a></h1>
<p>The publish API gives developers access to the underlying data structures and
methods used by the publish UI. They can use this interface to build more
advanced custom publish workflows.</p>
<p>The primary interface to the API is the <a class="reference internal" href="#publish-api-manager"><span class="std std-ref">PublishManager</span></a> class which
exposes the same <code class="docutils literal notranslate"><span class="pre">collection</span></code>, <code class="docutils literal notranslate"><span class="pre">validation</span></code>, <code class="docutils literal notranslate"><span class="pre">publish</span></code>, and <code class="docutils literal notranslate"><span class="pre">finalize</span></code>
methods that drive the Publisher UI. The manager contains a reference to a
<a class="reference internal" href="#publish-api-tree"><span class="std std-ref">PublishTree</span></a> instance that operates on the hierarchy of
<a class="reference internal" href="#publish-api-item"><span class="std std-ref">PublishItem</span></a> instances (the “things” to be published), each of which
can have associated <a class="reference internal" href="#publish-api-task"><span class="std std-ref">PublishTask</span></a> instances that define how the
items are to be processed.</p>
<p>The code below shows how to execute a complete publish using this API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># need to have an engine running in a context where the publisher has been</span>
<span class="c1"># configured.</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">sgtk</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">current_engine</span><span class="p">()</span>

<span class="c1"># get the publish app instance from the engine&#39;s list of configured apps</span>
<span class="n">publish_app</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tk-multi-publish2&quot;</span><span class="p">)</span>

<span class="c1"># ensure we have the publisher instance.</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">publish_app</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The publisher is not configured for this context.&quot;</span><span class="p">)</span>

<span class="c1"># create a new publish manager instance</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">publish_app</span><span class="o">.</span><span class="n">create_publish_manager</span><span class="p">()</span>

<span class="c1"># now we can run the collector that is configured for this context</span>
<span class="n">manager</span><span class="o">.</span><span class="n">collect_session</span><span class="p">()</span>

<span class="c1"># collect some external files to publish</span>
<span class="n">manager</span><span class="o">.</span><span class="n">collect_files</span><span class="p">([</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">,</span> <span class="n">path3</span><span class="p">])</span>

<span class="c1"># validate the items to publish</span>
<span class="n">tasks_failed_validation</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="c1"># oops, some tasks are invalid. see if they can be fixed</span>
<span class="k">if</span> <span class="n">tasks_failed_validation</span><span class="p">:</span>
    <span class="n">fix_invalid_tasks</span><span class="p">(</span><span class="n">tasks_failed_validation</span><span class="p">)</span>
    <span class="c1"># try again here or bail</span>

<span class="c1"># all good. let&#39;s publish and finalize</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
    <span class="c1"># If a plugin needed to version up a file name after publish</span>
    <span class="c1"># it would be done in the finalize.</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;There was trouble trying to publish!&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
<p>See the documentation for each of these classes below for more detail on how
to use them.</p>
<div class="section" id="publishmanager">
<span id="publish-api-manager"></span><h2>PublishManager<a class="headerlink" href="#publishmanager" title="Permalink to this headline">¶</a></h2>
<p>This class gives developers direct access to the same methods and data
structures used by the Publish UI. You can create an instance of this class
directly via the configured publish app like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># need to have an engine running in a context where the publisher has been</span>
<span class="c1"># configured.</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">sgtk</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">current_engine</span><span class="p">()</span>

<span class="c1"># get the publish app instance from the engine&#39;s list of configured apps</span>
<span class="n">publish_app</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tk-multi-publish2&quot;</span><span class="p">)</span>

<span class="c1"># ensure we have the publisher instance.</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">publish_app</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The publisher is not configured for this context.&quot;</span><span class="p">)</span>

<span class="c1"># create a new publish manager instance</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">publish_app</span><span class="o">.</span><span class="n">create_publish_manager</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="publishtree">
<span id="publish-api-tree"></span><h2>PublishTree<a class="headerlink" href="#publishtree" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="publishitem">
<span id="publish-api-item"></span><h2>PublishItem<a class="headerlink" href="#publishitem" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="publishtask">
<span id="publish-api-task"></span><h2>PublishTask<a class="headerlink" href="#publishtask" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="publishdata">
<span id="publish-api-data"></span><h2>PublishData<a class="headerlink" href="#publishdata" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="pluginsetting">
<span id="publish-api-setting"></span><h2>PluginSetting<a class="headerlink" href="#pluginsetting" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="logging.html" class="btn btn-neutral float-right" title="Logging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="customizing.html" class="btn btn-neutral float-left" title="Publish Customization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Autodesk

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 

  <script type="text/javascript">
    window.wafCCPAForceShow = true;
    (function(a,b,c,d){
      a='https://tags.tiqcdn.com/utag/autodesk/micro-opt/prod/utag.js';
      b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
      a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
  </script>


</body>
</html>